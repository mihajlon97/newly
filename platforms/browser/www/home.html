<!DOCTYPE HTML>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1" />
<title>Newly</title>
<link rel="stylesheet" type="text/css" href="styles/style.css">
<link rel="stylesheet" type="text/css" href="styles/framework.css">
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,500,500i,700,700i,900,900i" rel="stylesheet">
</head>

<body>
<!-- Preloader -->
<div id="preloader" class="preloader-bg">
	<h1></h1>
	<div id="preload-spinner"></div>
	<p>Hunt the truth!</p>
	<em>We will keep you informed</em>
</div>

<div id="page-transitions">
	<!-- Header -->
	<div id="header" class="header-home header-dark">
		<a href="#" class="header-logo"></a>
		<a href="javascript:;" class="header-icon header-icon-1 hamburger-animated" data-deploy-menu="menu-1"></a>
		<a id="loop" href="#" class="header-icon header-icon-2 font-14 " data-deploy-menu="menu-2"><i class="fa fa-search"></i></a>
		<a id="profile" href="profile.html" class="header-icon header-icon-4 font-14 no-border"><i class="fa fa-user"></i></a>
	</div>

    <!-- Sidebar Menu-->
    <div id="menu-1" class="menu-wrapper menu-dark menu-sidebar menu-sidebar-s">
        <div class="menu-scroll">
            <div class="menu">
                <a href="javascript:;" class="active-item"><i class="fa fa-home "></i>			<em>Home 			</em><i class="fa fa-caret-left"></i></a>
				<a href="#" style="height:30px!important;" ><i style="line-height: 30px!important;" class="fa fa-angle-double-down"></i></a>
				<a href="query.html?q=tech		"><i class="fa fa-cog"></i>						<em>Tech 			</em></a>
                <a href="query.html?q=health	"><i class="fa fa-envira"></i>					<em>Health 			</em></a>
                <a href="query.html?q=sport		"><i class="fa fa-soccer-ball-o"></i>			<em>Sports  		</em></a>
                <a href="query.html?q=politics	"><i class="fa fa-newspaper-o"></i>				<em>Politics 		</em></a>
                <a href="query.html?q=economy	"><i class="fa fa-line-chart"></i>				<em>Economy 		</em></a>
                <a href="query.html?q=science	"><i class="fa fa-institution"></i>				<em>Science 		</em></a>
                <a href="query.html?q=travel	"><i class="fa fa-plane"></i>					<em>Travel 			</em></a>
				<a href="query.html?q=crypto	"><i class="fa fa-bitcoin"></i>					<em>Crypto 			</em></a>
				<a href="query.html?q=style		"><i class="fa fa-camera"></i>					<em>Style 			</em></a>
				<a href="javascript:;" data-deploy-menu="suprise-me" ><i class="fa fa-gift"></i><em>Suprise me 		</em></a>
				<a href="sources.html"><i class="fa fa-bullhorn"></i>							<em>Sources 		</em></a>
				<a href="weather.html"><i class="fa fa-sun-o"></i>								<em>Weather			</em></a>
				<a href="index.html"><i class="fa fa-star"></i>									<em>Tutorial 		</em></a>
				<a href="#" class="close-menu"><i class="fa fa-times"></i>						<em>Close 			</em></a>
                <div class="clear"></div>
            </div>
        </div>
    </div>

	<!-- Search Menu -->
	<div id="menu-2" data-menu-size="255" class="menu-wrapper menu-dark menu-bottom menu-search">
		<div class="menu-form">
			<form action="query.html" method="GET" class="searchForm" id="searchForm">
				<fieldset>
					<div class="menu-search-title half-top">
						<h4>Let's search!</h4>
						<h5 class="full-bottom">Type a keyword you want to search latest news for.</h5>
					</div>
					<div class="formFieldWrap">
						<label class="field-title ssearchField"></label>
						<input type="text" name="q" placeholder="Keyword" value="" class="searchField" id="ssearchField" />
					</div>
					<div class="searchButton">
						<input type="submit" class="close-menu buttonWrap searchSubmitButton" id="searchSubmitButton" value="Search"/>
					</div>
				</fieldset>
			</form>
		</div>
	</div>

	<!-- Suprise me -->
	<div id="suprise-me" data-menu-size="545" class="menu-wrapper menu-dark menu-modal">
		<div id="supriseMe">

		</div>
		<a id="no-suprise" href="javascript:;" class="close-text close-menu center-text">No, thank you!</a>
	</div>

	<!-- Reading bar -->
	<div class="reading-bar"><div class="reading-line"></div></div>

	<div id="page-content" class="page-content page-content-gray">
		<div id="page-content-scroll">

			<div class="coverpage">
				<div id="cover-news" class="cover-slider owl-carousel owl-no-dots">

					<div id="coverinit" class="cover-item" style="background-image:url(images/pictures_vertical/bg1.jpg);">
						<div class="cover-content cover-content-bottom">
							<span class="cover-tag bg-red-dark">TRAVEL</span>
							<span class="cover-small-text opacity-40">April 27th, 2018</span>
							<h1 class="color-white left-text uppercase bold full-top no-bottom">The Big apple</h1>
							<p class="color-white font-11 quarter-bottom">New York in <a href="#">City News</a></p>
							<p class="color-white left-text opacity-40 no-bottom">Apple plans to purchase Empire State building, New York to literally become the "Big Apple"</p>
							<a href="#" class="half-top small-bottom font-12 color-gray-light float-left opacity-40">by New York Times</a>
							<a href="#" class="half-top small-bottom font-12 color-blue-dark float-right">Read More<i class="fa fa-angle-right icon-clear-left"></i></a>
						</div>
						<div class="cover-overlay overlay overlay-gradient"></div>

					</div>

				</div>
			</div>

			<!-- Favourite Categories Tabs -->
			<div class="news-home">
				<div class="news-tabs bg-white">
					<a href="javascript:;" data-tab="news-tab-1" class="one-third center-text">Tech</a>
					<a href="javascript:;" data-tab="news-tab-2" class="one-third center-text active-tab-button">Health</a>
					<a href="javascript:;" data-tab="news-tab-3" class="one-third last-column center-text">Sports</a>
					<div class="clear"></div>
				</div>
				<div class="news-tabs-content">
					<div class="tab-item" id="news-tab-1">
						<h3 class="uppercase bold no-top no-bottom center-text"><i class="fa fa-cog color-blue-dark icon-clear-right"></i>Lovely news in Tech</h3>
						<div id="tab1-news" class="double-slider owl-carousel owl-has-dots half-bottom">
							<div id="techinit" class="category-chosen"></div>
						</div>
					</div>
					<div class="tab-item active-tab" id="news-tab-2">
						<h3 class="uppercase bold no-top no-bottom center-text"><i class="fa fa-leaf color-green-dark icon-clear-right"></i>Lovely news in Health</h3>
						<div id="tab2-news" class="double-slider owl-carousel owl-has-dots half-bottom">
							<div id="healthinit" class="category-chosen"></div>
						</div>
					</div>
					<div class="tab-item" id="news-tab-3">
						<h3 class="uppercase bold no-top no-bottom center-text"><i class="fa fa-soccer-ball-o color-black icon-clear-right"></i>Lovely news in Sport</h3>
						<div id="tab3-news" class="double-slider owl-carousel owl-has-dots half-bottom">
							<div id="sportinit" class="category-chosen"></div>
						</div>
					</div>
				</div>

				<div class="decoration decoration-margins"></div>
				<h3 class="center-text small-bottom"><i class="fa fa-bitcoin color-black icon-clear-right"></i>Because you read about Bitcoin</h3>
				<div class="decoration decoration-margins"></div>

			</div>

			<div class="decoration decoration-margins"></div>

			<h5 class="uppercase bold half-top small-bottom center-text"><i class="fa fa-angellist color-blue-dark icon-clear-right"></i>Newly's recommendation </h5>
			<div class="content content-boxed">
				<div id="relatedNews" class="single-slider owl-carousel owl-no-dots">
					<div class="related-news"></div>
				</div>
			</div>

			<div class="decoration decoration-margins"></div>

			<!-- Categories -->
			<div class="categories small-bottom">
				<a href="query.html?q=tech">	<strong></strong><em>Tech 			</em><span class="bg-black opacity-50"></span><img src="images/pictures/8s.jpg" class="responsive-image" alt="img"></a>
				<a href="query.html?q=health">	<strong></strong><em>Health 		</em><span class="bg-black opacity-50"></span><img src="images/pictures/5s.jpg" class="responsive-image" alt="img"></a>
				<a href="query.html?q=sport">	<strong></strong><em>Sports  		</em><span class="bg-black opacity-50"></span><img src="images/pictures/11.jpg" class="responsive-image" alt="img"></a>
				<a href="query.html?q=politics"><strong></strong><em>Politics 		</em><span class="bg-black opacity-50"></span><img src="images/pictures/12.jpg" class="responsive-image" alt="img"></a>
				<a href="query.html?q=economy">	<strong></strong><em>Economy 		</em><span class="bg-black opacity-50"></span><img src="images/pictures/13.jpg" class="responsive-image" alt="img"></a>
				<a href="query.html?q=science">	<strong></strong><em>Science 		</em><span class="bg-black opacity-50"></span><img src="images/pictures/14.jpg" class="responsive-image" alt="img"></a>
				<a href="query.html?q=travel">	<strong></strong><em>Travel 		</em><span class="bg-black opacity-50"></span><img src="images/pictures/6t.jpg" class="responsive-image" alt="img"></a>
				<a href="query.html?q=crypto">	<strong></strong><em>Crypto 		</em><span class="bg-black opacity-50"></span><img src="images/pictures/15.jpg" class="responsive-image" alt="img"></a>
				<a href="query.html?q=style">	<strong></strong><em>Style 			</em><span class="bg-black opacity-50"></span><img src="images/pictures/10s.jpg" class="responsive-image" alt="img"></a>
				<div class="clear"></div>
			</div>

			<div class="decoration decoration-margins"></div>

			<!-- Footer -->
			<div class="footer footer-dark">
				<a href="#" class="footer-logo"></a>
				<p>Hunt the truth! <br>All sources fetched from Newsapi.org</p>
			</div>

		</div>
	</div>
</div>
	<a href="#" class="back-to-top-badge back-to-top-small"><i class="fa fa-angle-up"></i>Back to Top</a>
</div>

<script type="text/javascript" src="scripts/jquery.js"></script>
<script type="text/javascript" src="scripts/custom.js"></script>
<script type="text/javascript" src="scripts/plugins.js"></script>

<script>
    /*

        All news are loaded with ajax requests on Newsapi.org and are actual and original.
        In success callback function is all content parsed in html.

        articleUrl is var for redirecting on clicked article - Redirection works perfectly.
        Slider is initialized when news are ready and appended to html

    */

    $(document).ready(function() {
        var storage = window.localStorage;
        console.log(storage.getItem('profile'));
		if(storage.getItem('profile') == 'false'){
            $('#profile').hide();
            $('#loop').removeClass('header-icon-2')
            $('#loop').addClass('header-icon-4')
		}


        //Get actual news in english from Newsapi.org - Main news slider
        $.ajax({
            url: "https://newsapi.org/v2/top-headlines?country=us&language=en&apiKey=cc078c1c3a974f6dac7177de0a89e7a5",
            success: function(result){
                var articleUrl;
				var h = $('#cover-news').height();
				var w = $('#cover-news').width();
                result.articles.forEach(function (el) {
                    articleUrl = encodeURI(`article.html?title=${el.title}&desc=${el.description}&photo=${el.urlToImage}&src=${el.source.id}&cat=Breaking&url=${el.url}&time=${el.publishedAt.substring(0,10)}`);
                    if(el.urlToImage != null)
                    	$('#cover-news').append(`<div class="cover-item" style="background-image:url('${el.urlToImage}'); height: ${h}px; width: ${w}px;"><div class="cover-content cover-content-bottom"><span class="cover-tag bg-red-dark">Breaking</span><span class="cover-small-text opacity-40">${el.publishedAt.substring(0,10)}</span><h1 class="color-white left-text uppercase bold half-top no-bottom">${el.title}</h1><p class="color-white font-11 quarter-bottom"><a href="#"></a></p><p class="color-white left-text opacity-40 no-bottom">${el.description}</p><a href="#" class="half-top small-bottom font-12 color-gray-light float-left opacity-40">by ${el.source.name}</a><a href="${articleUrl}" class="half-top small-bottom font-12 color-blue-dark float-right">Read More<i class="fa fa-angle-right icon-clear-left"></i></a></div><div class="cover-overlay overlay overlay-gradient"></div></div>`);
                });

                $('.cover-slider').owlCarousel({loop:true, nav:false, items:1, autoplay: true, autoplayTimeout:5500});
                $('.cover-slider').trigger('remove.owl.carousel', 0).trigger('refresh.owl.carousel');;
                setTimeout(function(){$("#preloader").addClass('hide-preloader');},250);
                $('#preloader').addClass('hide-objects');
                $('body').prepend('<div class="page-change-preloader preloader-bg"><div id="preload-spinner"></div></div>');

            }
    	});

        //Get categories news in english from Newsapi.org - Main news slider
		//Categories are hardcoded for demo purposes. Database not yet implemented
		var categories = ["tech", "health", "sport"];
        categories.forEach(function (e) {
        	$.ajax({
        	    url: "https://newsapi.org/v2/top-headlines?q="+ e +"&language=en&apiKey=cc078c1c3a974f6dac7177de0a89e7a5",
        	    success: function(result){
                    var articleUrl;
        	        result.articles.forEach(function (el) {
                        articleUrl = encodeURI(`article.html?title=${el.title}&desc=${el.description}&photo=${el.urlToImage}&src=${el.source.id}&cat=${e}&url=${el.url}&time=${el.publishedAt.substring(0,10)}`);
        	            if(el.urlToImage != null)
        	                $('#tab'+(categories.indexOf(e)+1)+'-news').append(`<div class="category-chosen"><a href="${articleUrl}"><img src="${el.urlToImage}" alt="img"></a><span class="small-top color-green-dark">${el.source.name}</span><strong>${el.title}</strong><em>${el.description}</em></div>`);
        	        });

        	        $('#tab'+(categories.indexOf(e)+1)+'-news').owlCarousel({loop:true, margin:20, nav:false, autoHeight:true, items:2, autoplay: true, autoplayTimeout:3500});
        	        $('#tab'+(categories.indexOf(e)+1)+'-news').trigger('remove.owl.carousel', 0).trigger('refresh.owl.carousel');;
        	    }
        	});
        });


        //Crypto news - Hardcoded in section "Because user read about it"
        $.ajax({
            url: "https://newsapi.org/v2/top-headlines?q=bitcoin&language=en&apiKey=cc078c1c3a974f6dac7177de0a89e7a5",
            success: function(result){
                var suprise = false;
                var articleUrl;
                result.articles.forEach(function (el) {
                    articleUrl = encodeURI(`article.html?title=${el.title}&desc=${el.description}&photo=${el.urlToImage}&src=${el.source.id}&cat=Crypto&url=${el.url}&time=${el.publishedAt.substring(0,10)}`);
                    if(!suprise){
                        suprise=true;
                        $('#supriseMe').html(`<img class="responsive-image" src="${el.urlToImage}"/><h1 class="uppercase ultrabold center-text half-bottom">${el.title}</h1><p class="center-text"> ${el.description} </p><div class="modal-buttons"><a href="${articleUrl}" class="close-menu half-bottom button button-center button-green button button-s button-round ultrabold uppercase">Read more</a></div>`);
                    }
                    if(el.urlToImage != null && result.articles.indexOf(el) < 4)
                        $('.news-home').append(`<div class="article-card box-shadow  bg-white full-bottom"><a href="${articleUrl}" class="article-header"><span class="article-overlay"></span><img class="article-image" src="${el.urlToImage}"/><span class="article-category bg-red-dark color-white uppercase">Crypto</span><span class="article-author color-gray-light"><i class="fa fa-user opacity-50"></i>${el.source.name}</span><span class="article-time color-gray-light">${el.publishedAt.substring(0, 10)}<i class="fa fa-clock-o opacity-50"></i></span></a><div class="article-content"><h1 class="article-title half-top">${el.title}</h1><p class="small-bottom">${el.description}</p><a href="${articleUrl}" class="half-bottom right-text">Read more <i class="fa fa-angle-right icon-clear-left icon-clear-right"></i></a></div></div>`);
				});
            }
        });

        $('#no-suprise').click(function () {
            $.ajax({
                url: "https://newsapi.org/v2/top-headlines?q=bitcoin&language=en&apiKey=cc078c1c3a974f6dac7177de0a89e7a5",
                success: function(result){
                    shuffle(result.articles);
                    var articleUrl;
                  	var el = result.articles[0];
                    articleUrl = encodeURI(`article.html?title=${el.title}&desc=${el.description}&photo=${el.urlToImage}&src=${el.source.id}&cat=Crypto&url=${el.url}&time=${el.publishedAt.substring(0,10)}`);
                    $('#supriseMe').html(`<img class="responsive-image" src="${el.urlToImage}"/><h1 class="uppercase ultrabold center-text half-bottom">${el.title}</h1><p class="center-text"> ${el.description} </p><div class="modal-buttons"><a href="${articleUrl}" class="close-menu half-bottom button button-center button-green button button-s button-round ultrabold uppercase">Read more</a></div>`);

                }
            });
        });

       	//Get Related news from Newsapi.org for this user
        $.ajax({
            url: "https://newsapi.org/v2/top-headlines?country=us&language=en&apiKey=cc078c1c3a974f6dac7177de0a89e7a5",
            success: function(result){
                var articleUrl;
                shuffle(result.articles);
                result.articles.forEach(function (el) {
                    articleUrl = encodeURI(`article.html?title=${el.title}&desc=${el.description}&photo=${el.urlToImage}&src=${el.source.id}&cat=Breaking&url=${el.url}&time=${el.publishedAt.substring(0,10)}`);
                    if(el.urlToImage != null && result.articles.indexOf(el) < 6)
                        $('#relatedNews').append(`<div class="related-news"><a href="${articleUrl}" class="related-news-image"><img src="${el.urlToImage}"></a><div class="store-slide-title"><strong>${el.title}</strong><em class="color-gray-dark">${el.description}</em></div><div class="store-slide-button"><strong>${el.source.name}</strong><a href="${articleUrl}"><i class="fa fa-arrow-right color-blue-light"></i>Read more</a></div></div>`);
                });
                $('#relatedNews').owlCarousel({loop:true, margin:0, nav:false, autoHeight:true, items:1, autoplay: true, autoplayTimeout:3500});
                $('#relatedNews').trigger('remove.owl.carousel', 0).trigger('refresh.owl.carousel');;
            }
        });
    });
</script>

</body>
